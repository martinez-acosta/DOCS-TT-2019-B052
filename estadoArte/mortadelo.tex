\section{Mortadelo}
De acuerdo con de la Vega\cite{de_la_vega_mortadelo_2020}, Mortadelo está basado en el \textit{model driven}; es decir que para diseñar bases de datos NoSQL necesita de modelos conceptuales bien definidos.


Lo anterior implica usar dos modelos diferentes pero interrelacionados que añaden complejidad al modelado de la base datos; por esta razón de la Vega propone el Generic Data Metamodel (GDM), que es un modelo conceptual NoSQL donde la estructura (entidades, atributos, relaciones entre entidades) y patrones de acceso (cómo se consultarán los datos) están integradas en un mismo modelo conceptual.


Cabe destacar que el GDM es un modelo conceptual independiente del paradigma NoSQL, por lo que puede representar una base de datos NoSQL de clave-valor, orientado a documentos, orientado a columnas u orientado a grafos.


La figura~\ref{img:mortadelo-process} muestra los tres pasos principales de Mortadelo, empezando desde la izquierda con su propuesta de modelo conceptual NoSQL, el Generic Data Metamodel, siguiendo con una representación de los modelos lógicos orientado a columnas o documentos en los que realiza ``modelo a modelo'' (M2M) para generar el modelo lógico, para finalizar una transformación ``modelo a texto'' (M2T) con el modelo físico de cada modelo lógico, respectivamente.


\begin{figure}[H] 
    \centering
    \includegraphics[width=0.75\textwidth]{mortadelo/01.png}
    \caption{Mortadelo}
    \label{img:mortadelo-process}
\end{figure}

\subsubsection*{Mortadelo: modelo conceptual (Generic Data Metamodel)}

La figura~\ref{img:mortadelo-gdm} muestra el Generic Data Metamodel, que está compuesto por clases interrelacionadas entre sí con notación UML\footnote{La simbología usada en los diagramas de clase UML está en el apéndice} y consta de dos secciones principales: los elementos de la estructura (\textit{structure model elements}) y el cómo se realizarán las consultas (\textit{access queries elements}).


%Como se aprecia en la figura~\ref{img:mortadelo-gdm}, el modelo conceptual que propone de la Vega contiene en un mismo modelo con notación UML los elementos de la estructura (\textit{structure model elements}) y el cómo se realizarán las consultas (\textit{access queries elements}).


\begin{figure}[H] 
    \centering
    \includegraphics[width=0.75\textwidth]{mortadelo/GDM.png}
    \caption{Generic Data Metamodel}
    \label{img:mortadelo-gdm}
\end{figure}


A continuación se da una explicación de cada elemento de la figura~\ref{img:mortadelo-gdm} donde la clase \textit{model} es para indicar que un modelo GDM tiene $n$ entidades y $n$ consultas donde $n=0,1,...,n$.


\paragraph*{Structure model elements}


\begin{itemize}    
    
    \item Clase \textit{entity}: contiene \textit{features} y solo es referenciada directamente desde las clases \textit{from} y \textit{reference}.
    \item Clase \textit{feature}: es una clase abstracta, una \textit{reference}, un \textit{attribute}, o hereda de la clase \textit{annotatable element} para que la instancia de la clase sea comentada con indicadores de texto que proveen información extra para generar el modelo lógico. 
    \item Clase \textit{reference}: empieza con la palabra clave ``ref'', un nombre de tipo de entidad, una cardinalidad y un nombre de referencia. Por ejemplo: ``ref Category[*] categories'' define una referencia llamada \textit{categories}, del tipo de entidad \textit{category} con una cardinalidad de cero a varios.
    \item Clase \textit{attribute}: contiene un tipo y un identificador de unicidad.
    \item Clase \textit{annotatable element}: es una clase abstracta para permitir que una clase contenga anotaciones.
    \item Clase \textit{annotation}: es un indicador de texto que proveen sobre información extra para generar el modelo lógico.
    
\end{itemize}

\paragraph*{Access queries elements}


\begin{itemize}
    
    \item Clase \textit{query}: tiene solo un elemento de la clase \textit{from}, $n$ elementos de la clase \textit{attribute selection}, $n$ elementos de la clase \textit{inclusion} y tiene o no un único elemento de la clase \textit{boolean expression}.
    \item Clase \textit{from}: asocia una clase \textit{query} con la clase \textit{entity}; es la clase que permite referenciar un tipo de entidad.
    \item Clase \textit{attribute selection}: accede a los atributos de la \textit{entity} referenciada por la clase \textit{from} o la clase \textit{inclusion}.
    \item Clase \textit{boolean expression}: expresa una expresión booleana para declarar alguna restricción.
    \item Clase \textit{inclusion}: permite acceder en una \textit{query} a los atributos de otros tipos de entidad.
    
\end{itemize}

La figura~\ref{img:mortadelo-gdm.textual.notation} es una instancia del modelo conceptual GDM en su notación textual en la que se nota que, por ejemplo, en la tercera consulta se accede a los elementos de la entidad \textit{category} a través del elemento ref de la entidad \textit{product}.


\begin{figure}[H] 
    \centering
    \includegraphics[width=0.65\textwidth]{mortadelo/GDM-textual-notation.png}
    \caption{Notación textual del GDM}
    \label{img:mortadelo-gdm.textual.notation}
\end{figure}



\subsubsection*{Mortadelo: modelo lógico orientado a documentos}

De acuerdo con de la Vega\cite{de_la_vega_mortadelo_2020}, las bases de datos orientadas a documentos tienen como objetivo almacenar jerarquías de objetos que son probables que se consultarán juntas.


Estas jerarquías de objetos se conocen como documentos y se agrupan en colecciones; asimismo, una colección almacena documentos de la misma entidad y por lo general un documento está compuesto de pares clave-valor y contiene otros documentos incrustados.


En la figura~\ref{img:mortadelo-gdm-logical-model-document-oriented} se muestra el modelo lógico orientado a documentos de la herramienta Mortadelo y a continuación se explica cada clase que conforma el modelo.


\begin{figure}[H] 
    \centering
    \includegraphics[width=0.65\textwidth]{mortadelo/GDM-logical-model-document-oriented.png}
    \caption{Modelo lógico orientado a documentos de Mortadelo}
    \label{img:mortadelo-gdm-logical-model-document-oriented}
\end{figure}


\begin{itemize}
    \item Clase \textit{document data model}: está compuesta de $n$ \textit{collections}.
    \item Clase \textit{collection}: tiene un nombre que la identifica y en una colección se almacenan documentos que, en general, comparten la misma estructura.
    \item Clase \textit{document type}: define la estructura de los documentos a guardar con un conjunto de instancias de la clase \textit{field}.
    \item Clase \textit{field}: tiene instancias de las clases \textit{primitive field} (atributos simples), \textit{array field} (más instancias de la clase \textit{field}) o \textit{document type} (otras estructuras de documentos), permitiendo guardar elementos anidados.
    \item Clase \textit{primitive field}: contiene un tipo primitivo de dato
    \item Clase \textit{array field}: permite anidar más instancias de la clase \textit{field}
\end{itemize}


Como se ha mostrado, Mortadelo es quizá la herramienta más completa de las estudiadas y Alfonso de la Vega expone en su \textit{paper} no solo el modelado conceptual, lógico y físico de una base de datos NoSQL, sino también explica a detalle los algoritmos usados con casos de uso.