\section{Modelo entidad-relación a relacional}
Elmasri\cite{ramez_elmasri_fundamentos_nodate} propone un algoritmo en siete pasos para convertir las estructuras de un modelo ER básico con tipos de entidades fuertes y débiles, relaciones binarias con distintas restricciones estructurales, relaciones n-ary y atributos (simples, compuestos y multivalor) en relaciones.

\subsection*{Paso 1: Mapeado de los tipos de entidad regulares}
Por cada entidad (fuerte) regular $E$ del esquema ER cree una relación $R$ que incluya todos los atributos simples de $E$.


Incluya únicamente los atributos simples que conforman un atributo compuesto; seleccione uno de los atributos clave de $E$ como clave principal para $R$. 


Si la clave elegida de $E$ es compuesta, el conjunto de los atributos simples que la forman constituirán la clave principal de $R$.


Si durante el diseño conceptual se identificaron varias claves para $E$, la información que describe los atributos que forman cada clave adicional conserva su orden para especificar las claves (únicas) secundarias de la relación $R$. 


El conocimiento sobre las claves también es necesario para la indexación y otros tipos de análisis.


\subsection*{Paso 2: Mapeado de los tipos de entidad débiles}
Por cada tipo de entidad débil $W$ del esquema ER con el tipo de entidad propietario $E$, cree una relación $R$ e incluya todos los atributos simples (o componentes simples de los atributos compuestos) de $W$ como atributos de $R$. 


Además, incluya como atributos de la \textit{foreign key} de $R$, los atributos de la o las relaciones que correspondan al o los tipos de entidad propietarios; esto se encarga de identificar el tipo de relación de $W$. 


La clave principal de $R$ es la combinación de las claves principales del o de los propietarios y la clave parcial del tipo de entidad débil $W$ si la hubiera.


Si hay un tipo de entidad débil $E_{2}$ cuyo propietario también es un tipo de entidad débil $E_{1}$, $E_{1}$ debe asignarse antes que $E_{2}$ para determinar primero su clave principal.


\subsection*{Paso 3: Mapeado de los tipos de relación 1:1 binaria}

Por cada tipo de relación 1:1 binaria $R$ del esquema ER, identifique las relaciones $S$ y $T$ que corresponden a los tipos de entidad que participan en $R$. Hay tres metodologías posibles: (1) la metodología de la foreign key, (2) la metodología de la relación mezclada y (3) la metodología de referencia cruzada o relación de relación. La primera metodología es la más útil y la que debe seguirse salvo que se den ciertas condiciones especiales, como las que explicamos a continuación:

\begin{enumerate}
    \renewcommand\labelenumi{\bfseries\theenumi}
    \item \textbf{Metodología de la \textit{foreign key}}: seleccione una de las relaciones (por ejemplo, $S$) e incluya como \textit{foreign key} en $S$ la clave principal de $T$. Lo mejor es elegir un tipo de entidad con participación total en $R$ en el papel de $S$. Incluya todos los tributos simples (o los componentes simples de los atributos compuestos) del tipo de relación 1:1 $R$ como atributos de $S$.
    
    \item \textbf{Metodología de la relación mezclada}:  una asignación alternativa de un tipo de relación 1:1 es posible al mezclar los dos tipos de entidad y la relación en una sola relación. Esto puede ser apropiado cuando las dos participaciones son totales.
    
    \item \textbf{Metodología de referencia cruzada o relación de relación}: consiste en configurar una tercera relación $R$ con el propósito de crear una referencia cruzada de las claves principales de las relaciones $S$ y $T$ que representan los tipos de entidad. Como veremos, esta metodología es necesaria para las relaciones $M:N$ binarias. La relación $R$ se denomina relación de relación (y, en algunas ocasiones, tabla de búsqueda), porque cada tupla de $R$ representa una instancia de relación que relaciona una tupla de $S$ con otra de $T$.
\end{enumerate}

\subsection*{Paso 4: Mapeado de tipos de relaciones 1:N binarias}
Por cada relación $1:N$ binaria regular $R$, identifique la relación $S$ que representa el tipo de entidad participante en el lado $N$ del tipo de relación. 


Incluya como \textit{foreign key} en $S$ la clave principal de la relación $T$ que representa el otro tipo de entidad participante en $R$; hacemos esto porque cada instancia de entidad en el lado $N$ está relacionada, a lo sumo, con una instancia de entidad del lado 1 del tipo de relación. 


Incluya cualesquiera atributos simples (o componentes simples de los atributos compuestos) del tipo de relación $1:N$ como atributos de $S$.


De nuevo, una metodología alternativa es la opción de relación de relación (referencia cruzada), como en el
caso de las relaciones 1:1 binarias. 


Creamos una relación $R$ separada cuyos atributos son las claves de $S$ y $T$, y cuya clave principal es la misma que la clave de $S$. Esta opción puede utilizarse si pocas tuplas de $S$ participan en la relación para evitar excesivos valores NULL en la \textit{foreign key}.


\subsection*{Paso 5: Mapeado de tipos de relaciones M:N binarias}

Por cada tipo de relación $M:N$ binaria $R$ cree una nueva relación $S$ para representar a R.


Incluya como atributos de la \textit{foreign key} en $S$ las claves principales de las relaciones que representan los tipos de entidad participantes; su combinación formará la clave principal de $S$.


Incluya también cualesquiera atributos simples del tipo de relación $M:N$ (o los componentes simples de los atributos compuestos) como atributos de $S$.


No podemos representar un tipo de relación $M:N$ con un atributo de \textit{foreign key} en una de las relaciones participantes (como hicimos para los tipos de relación $1:1$ o $1:N$) debido a la razón de cardinalidad $M:N$; debemos crear una relación de relación $S$ separada.

Siempre podemos asignar las relaciones $1:1$ o $1:N$ de un modo similar a las relaciones $M:N$ utilizando la metodología de la referencia cruzada (relación de relación), como explicamos anteriormente. 


Esta alternativa es particularmente útil cuando existen pocas instancias de relación, a fin de evitar valores NULL en las \textit{foreign keys}.


En este caso, la clave principal de la relación de relación sólo será una de las \textit{foreign keys} que hace referencia a las relaciones de entidad participantes. 


Para una relación $1:N$, la clave principal de la relación de relación será la \textit{foreign key} que hace referencia a la relación de la entidad en el lado $N$.


En una relación $1:1$, cada \textit{foreign key} se puede utilizar como la clave principal de la relación de relación, siempre y cuando no haya entradas NULL en la relación.




\subsection*{Paso 6: Mapeado de atributos multivalor}

Por cada atributo multivalor $A$, cree una nueva relación $R$.


Esta relación incluirá un atributo correspondiente a $A$, más el atributo clave principal $K$ (como \textit{foreign key} en $R$) de la relación que representa el tipo de entidad o tipo de relación que tiene $A$ como un atributo.


La clave principal de $R$ es la combinación de $A$ y $K$. Si el atributo multivalor es compuesto, incluimos sus componentes simples.


\subsection*{Paso 7: Mapeado de los tipos de relación n-ary}
Por cada tipo de relación n-ary $R$, donde $n > 2$, cree una nueva relación $S$ para representar $R$.


Incluya como atributos de la \textit{foreign key} en $S$ las claves principales de las relaciones que representan los tipos de entidad participantes. 


Incluya también cualesquiera atributos simples del tipo de relación n-ary (o los componentes simples de los atributos compuestos) como atributos de $S$.


Normalmente, la clave principal de $S$ es una combinación de todas las \textit{foreign keys} que hacen referencia a las relaciones que representan los tipos de entidad participantes.


No obstante, si las restricciones de cardinalidad en cualquiera de los tipos de entidad $E$ que participan en $R$ es 1, entonces la clave principal de $S$ no debe incluir el atributo de la \textit{foreign key} que hace referencia a la relación $E'$ correspondiente a $E$.

